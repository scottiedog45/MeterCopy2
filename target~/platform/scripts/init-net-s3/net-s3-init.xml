<?xml version="1.0" encoding="UTF-8"?>
<!--
  ANT Buildfile

  Copyright 2014-2016 IS2T. All rights reserved.
  IS2T PROPRIETARY/CONFIDENTIAL. Use is subject to license terms.

-->
<project name="net-embedded-s3-init">

	<import file="${scripts.dir}/extension-init.xml" />

	<target name="context/net-embedded-s3" extensionOf="init/context">
		<!-- check if application targets Net Embedded -->
		<available classpath="${application.classpath}" classname="com.is2t.support.net.NetworkAddress" property="usesNETEMBEDDED"/>
		<condition property="usesNETEMBEDDEDS3" value="SET">
			<and>
				<isset property="usesNETEMBEDDED"/>
				<isset property="onS3"/>
			</and>
		</condition>
	</target>
	
	<target name="init/net-embedded-s3" extensionOf="init/execution" if="usesNETEMBEDDEDS3">
		<!-- MOCK -->
		<augment id="hil.main.classpath">
			<fileset dir="${platform.dir}/mocks" includes="mockNet.jar"/>
			<fileset dir="${platform.dir}/javaLibs" includes="sni*.jar"/>
		</augment>
		
		<property name="java.net.preferIPv4Stack" value="true"/>
		<property name="java.net.preferIPv6Stack" value="false"/>
		<augment id="hil.main.properties">
			<propertyref name="java.net.preferIPv4Stack"/>
			<propertyref name="java.net.preferIPv6Stack"/>
		</augment>
		
		<!-- CLASSPATH -->
		<augment id="init.application.classpath">
			<fileset dir="${platform.dir}/javaLibs">
				<include name="sni*.jar"/>
			</fileset>
			<fileset dir="${platform.dir}/S3/javaLibs">
				<include name="net-embedded-dns-*.jar"/>
			</fileset>
		</augment>
		
		<!-- REQUIRES -->
		<augment id="init.requires">
			<!-- types loaded through DependencyInjectionHelper (couple: getName/forName)-->
			<string value="com.is2t.support.net.dns.NativeDNSResolver"/>
		</augment>
	</target>
	
	<target name="finalization/net-embedded-s3" extensionOf="init/finalization">
		
	</target>
	
</project>