<?xml version="1.0" encoding="UTF-8"?>
<!--
	ANT
 
	Copyright 2017-2018 IS2T. All rights reserved.
	Modification and distribution is permitted under certain conditions.
  	IS2T PROPRIETARY/CONFIDENTIAL. Use is subject to license terms.
-->
<project name="resourceBufferGeneratorInit">

	<dirname property="ant.dir.resourceBufferGeneratorInit" file="${ant.file.resourceBufferGeneratorInit}"/>
	<import file="${ant.dir.resourceBufferGeneratorInit}/../extension-init.xml" />

	<target name="resourceBufferGeneratorInit:run">
		<path id="resourceBufferGenerator.classpath.ref">
			<fileset dir="${jpf.dir}/tools/resourceBufferGenerator" includes="*.jar"/>
		</path>
		<taskdef name="resourceBufferGenerator" classname="com.is2t.bon.generator.ant.ResourceBufferGeneratorTask" classpathref="resourceBufferGenerator.classpath.ref"/>
		
		<!-- create tmp dir -->
		<property name="resourceBuffer.files.dir" location="${application.output.dir}/resourceBuffer"/>
		<mkdir dir="${resourceBuffer.files.dir}"/>
		
		<!-- generates platform dependant files -->
		<resourceBufferGenerator
			listExtension=".resourcebuffer.list"
			classpath="${application.classpath}" 
			pathSeparator="${path.separator}"
			endianness="${arch.endianness}"
			outputDirectory="${resourceBuffer.files.dir}"
		/>
		
		<!-- add tmp dir in classpath -->
		<augment id="init.application.classpath">
			<dirset dir="${resourceBuffer.files.dir}"/>
		</augment>	
	</target>
	
	<target name="resourceBufferGeneratorInit:exec" extensionOf="init/execution" depends="resourceBufferGeneratorInit:run"/>
		
	<target name="resourceBufferGeneratorInit:dynexec" extensionOf="dyninit/execution" depends="resourceBufferGeneratorInit:run"/>
	
</project>